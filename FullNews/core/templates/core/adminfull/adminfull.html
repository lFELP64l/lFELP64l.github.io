{% extends 'core/baseAdmin.html' %}
{% load static %}
{% block content %}

<div class="conteiner">
  <div class="p-5 bg-dark text-white text-center">
    <h1>ADMINISTRAR NOTICIAS</h1>
    <p>(aceptar o rechazar)</p>
  </div>
  <div class="d-flex justify-content-center row">
    <section class="intro">
      <div class="bg-image h-100" style="background-color: #6095F0;">
        <div class="mask d-flex align-items-center h-100">
          <div class="container">
            <div class="row justify-content-center">
              <div class="col-12">
                <div class="card shadow-2-strong" style="background-color: #f5f7fa;">
                  <div class="card-body">

                    {% for aux in lista %}
                    <div class="accordion" id="accordionPanelsStayOpenExample">
                      <div class="accordion-item">
                        <h2 class="accordion-header" id="panelsStayOpen-headingOne">
                          <button class="accordion-button" type="button" data-bs-toggle="collapse"
                            data-bs-target=#panelsStayOpen-collapseOne" aria-expanded="true" aria-controls="panelsStayOpen-collapseOne">
                            <span>Titulo:{{ aux.titulo }}&nbsp;</span><span>Categoria:{{ aux.categoria }}</span>
                          </button>
                        </h2>
                        <div id="panelsStayOpen-collapseOne" class="accordion-collapse collapse show" aria-labelledby="panelsStayOpen-headingOne">
                          <div class="accordion-body">
                            <div class="d-flex row">
                              <strong><span>autor: </span>{{ aux.autor_username }} &nbsp; <span>ubicacion: </span>{{ aux.ubicacion }} &nbsp; <span>publicado el: </span>{{ aux.fecha }}</strong>
                              <h5>texto noticia:</h5>
                              <p>{{ aux.texto }}</p>
                              {% if aux.imagen1 %}
                                <div class="col-4 d-flex justify-content.center">
                                  <img src="{{ aux.imagen1.url }}" alt="" width=60% height=80%>
                                </div>
                              {% endif %}
                              {% if aux.imagen2 %}
                                <div class="col-4 d-flex justify-content.center">
                                  <img src="{{ aux.imagen2.url }}" alt="" width=60% height=80%>
                                </div>
                              {% endif %}
                              {% if aux.imagen3 %}
                                <div class="col-4 d-flex justify-content.center">
                                  <img src="{{ aux.imagen3.url }}" alt="" width=60% height=80%>
                                </div>
                              {% endif %}

                              <!-- Button trigger modal -->
                                <button type="button" class="btn btn-primary mb-2" data-bs-toggle="modal" data-bs-target="#exampleModal">
                                  Aprobar
                                </button>

                                <!-- Modal -->
                                <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
                                  <div class="modal-dialog">
                                    <div class="modal-content">
                                      <div class="modal-header">
                                        <h5 class="modal-title" id="exampleModalLabel">Â¿Seguro que quieres aprobar?</h5>
                                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                      </div>
                                      <div class="modal-footer">
                                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
                                        <form action="{% url 'cambiar_estado' aux.id %}" method="post" style="display: inline;">
                                          {% csrf_token %}
                                          <button class="btn btn-primary mb-3" type="submit" name="estado" value="2">Aprobar</button>
                                        </form>
                                      </div>
                                    </div>
                                  </div>
                                </div>

                              <!-- Button trigger modal -->
                              <button type="button" class="btn btn-danger" data-bs-toggle="modal" data-bs-target="#exampleModal2">
                                rechazar
                              </button>

                              <!-- Modal -->
                              <div class="modal fade" id="exampleModal2" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
                                <div class="modal-dialog">
                                  <div class="modal-content">
                                    <div class="modal-header">
                                      <h5 class="modal-title" id="exampleModalLabel">ingresa porque rechazas la noticia</h5>
                                      <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                    </div>
                                    <div class="modal-body">
                                      <form action="{% url 'cambiar_estado' aux.id %}" method="post" style="display: inline;">
                                        {% csrf_token %}
                                        <textarea class="form-control" id="exampleFormControlTextarea1" rows="3" name="mensaje" placeholder="Si rechaza ingrese un mensaje" required></textarea>
                                        <button class="btn btn-danger m-1" type="submit" name="estado" value="3" >Rechazar</button>
                                      </form>
                                    </div>
                                    <div class="modal-footer">
                                      <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
                                    </div>
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                      {% empty %}
                      <h2>No hay noticicas disponibles</h2>
                    </div>
                    {% endfor %}
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
  </div>
  </section>
</div>
</div>

{% endblock %}